<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir='ltr' lang='en-US' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='Content-type' />
    <title>Matt Sears | git</title>
    <meta content='Matt Sears, Matt, Sears' name='keywords' />
    <meta author='Matt Sears' />
    <link href='http://feeds.feedburner.com/mattsears' rel='alternate' title='Feed for mattsears' type='application/atom+xml' />
    <link href='/images/favicon.png' rel='shortcut icon' />
    <link href='/style.css' media='all' rel='stylesheet' type='text/css' />
    <!--[if IE 6]>
      <link rel="stylesheet" href="css/ie6.css" type="text/css" media="all" />
    <![endif]-->
    <script charset='utf-8' src='/javascripts/jquery-1.4.2.min.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/cufon-yui.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/titillium_400_mod2.font.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/titillium_800_mod2.font.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/cross-fade.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/jquery.tipsy.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/application.js' type='text/javascript'></script>
  </head>
  <body class='articles'>
    <div class='page-bg'>&nbsp;</div>
    <div id='header'>
      <div class='shell'>
        <div class='cl'>&nbsp;</div>
        <a href='/'>
          <h1 class='nocufon' id='logo'></h1>
        </a>
        <div class='right'>
          <div class='cl'>&nbsp;</div>
          <div id='navigation'>
            <ul>
              <li class='home-link'>
                <a href='/'>Home</a>
              </li>
              <li class='divider'>/</li>
              <li class='articles-link'>
                <a href='/articles'>Articles</a>
              </li>
              <li class='divider'>/</li>
              <li class='tumblr-link'>
                <a href='http://mattsears.tumblr.com'>Notebook</a>
              </li>
              <li class='divider'>/</li>
              <li class='about-link'>
                <a href='/about'>About</a>
              </li>
            </ul>
          </div>
          <div class='cl'>&nbsp;</div>
        </div>
        <div class='cl'>&nbsp;</div>
      </div>
    </div>
    <div id='main'>
      <div class='shell'>
          <div id='content'>
            <div id='content-top'></div>
            <div class='posts'>
              <div class='post rounded-top'>
                <div class='head'>
                  <h2>
                    <a href='/articles/2011/10/20/gaga-key-value-store'>
                      Gaga: A Git-Backed Key/Value Store
                    </a>
                    <span>
                      <a class='dsq-comment-count comment-link commentslink' href='http://www.mattsears.com/articles/2011/10/20/gaga-key-value-store#disqus_thread'></a>
                    </span>
                  </h2>
                  <div class='cl'>&nbsp;</div>
                </div>
                <div class='body'>
                  <p class='with-border'>
                    <p>Gaga originated from my winning entry in Codebrawl's <a href="http://codebrawl.com/contests/key-value-stores">Key/Value
                    Store</a> contest. The challenge
                    was to write the best key/value storage backend you can think of. Since Git is
                    fast, reliable, and a great tool for storing source code, I was really
                    interested in making an easy way to store key/values.</p><p>Built with <a href="https://github.com/mojombo/grit">Grit</a>, Gaga supports SET, GET, KEYS,
                    and DELETE operations. And since it's Git, we can easily enhance it to include
                    other awesome Git features such as branches, diffs, reverting, etc.</p><h2>Usage</h2><div class="highlight">
                    <pre><span class="vi">@gaga</span> <span class="o">=</span> <span class="no">Gaga</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:repo</span> <span class="o">=&gt;</span> <span class="s1">'/path/to/repo'</span><span class="p">)</span>&#x000A;&#x000A;<span class="c1"># SET</span>&#x000A;<span class="vi">@gaga</span><span class="o">[</span><span class="s1">'lady'</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"gaga"</span>&#x000A;&#x000A;<span class="c1"># GET</span>&#x000A;<span class="vi">@gaga</span><span class="o">[</span><span class="s1">'lady'</span><span class="o">]</span> <span class="c1">#=&gt; "gaga"</span>&#x000A;&#x000A;<span class="c1"># KEYS</span>&#x000A;<span class="vi">@gaga</span><span class="o">.</span><span class="n">keys</span>  <span class="c1">#=&gt; ['lady']</span>&#x000A;&#x000A;<span class="c1"># DELETE</span>&#x000A;<span class="vi">@gaga</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">'lady'</span><span class="p">)</span> <span class="c1">#=&gt; 'gaga'</span>&#x000A;&#x000A;<span class="c1"># Remove all items from the store</span>&#x000A;<span class="vi">@gaga</span><span class="o">.</span><span class="n">clear</span></pre>
                    </div><p>That works pretty well. Now, we can harness the power of Git and enhance our data
                    store. For example, we can get a history log for a specific key:</p><div class="highlight">
                    <pre><span class="c1"># LOG</span>&#x000A;<span class="vi">@gaga</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">'lady'</span><span class="p">)</span>&#x000A;&#x000A;<span class="c1"># Produces:</span>&#x000A;<span class="o">[</span>&#x000A; <span class="p">{</span><span class="s2">"message"</span><span class="o">=&gt;</span><span class="s2">"all clear"</span><span class="p">,</span><span class="s2">"committer"</span><span class="o">=&gt;</span><span class="p">{</span><span class="s2">"name"</span><span class="o">=&gt;</span><span class="s2">"Matt Sears"</span><span class="p">,</span> <span class="s2">"email"</span><span class="o">=&gt;</span><span class="s2">"matt@mattsears.com"</span><span class="p">},</span> <span class="s2">"committed_date"</span><span class="o">=&gt;</span><span class="s2">"2011-09-05..."</span><span class="p">},</span>&#x000A; <span class="p">{</span><span class="s2">"message"</span><span class="o">=&gt;</span><span class="s2">"set 'lady' "</span><span class="p">,</span> <span class="s2">"committer"</span><span class="o">=&gt;</span><span class="p">{</span><span class="s2">"name"</span><span class="o">=&gt;</span><span class="s2">"Matt Sears"</span><span class="p">,</span> <span class="s2">"email"</span><span class="o">=&gt;</span><span class="s2">"matt@mattsears.com"</span><span class="p">},</span> <span class="s2">"committed_date"</span><span class="o">=&gt;</span><span class="s2">"2011-09-05..."</span><span class="p">}</span>&#x000A; <span class="p">{</span><span class="s2">"message"</span><span class="o">=&gt;</span><span class="s2">"delete 'lady' "</span><span class="p">,</span> <span class="s2">"committer"</span><span class="o">=&gt;</span><span class="p">{</span><span class="s2">"name"</span><span class="o">=&gt;</span><span class="s2">"Matt Sears"</span><span class="p">,</span> <span class="s2">"email"</span><span class="o">=&gt;</span><span class="s2">"matt@mattsears.com"</span><span class="p">},</span> <span class="s2">"committed_date"</span><span class="o">=&gt;</span><span class="s2">"2011-09-05..."</span><span class="p">}</span>&#x000A;<span class="o">]</span></pre>
                    </div><p>This is just a start. There's still a lot things we can add.  If you are interested in more detailed information, check out the repo
                    on <a href="https://github.com/mattsears/gaga">Github</a>.</p>
                  </p>
                </div>
              </div>
              <div class='post-bottom'>
                <script type='text/javascript'>
                  //<![CDATA[
                    var disqus_shortname = 'mattsears'; // required: replace example with your forum shortname
                    var disqus_identifier = "/articles/2011/10/20/gaga-key-value-store/";
                    var disqus_url = "http://www.mattsears.com/articles/2011/10/20/gaga-key-value-store";
                  //]]>
                </script>
              </div>
              
              <div class='post rounded-top'>
                <div class='head'>
                  <h2>
                    <a href='/articles/2009/4/4/git-blogging-with-aerial'>
                      Git blogging with Aerial
                    </a>
                    <span>
                      <a class='dsq-comment-count comment-link commentslink' href='http://www.mattsears.com/articles/2009/4/4/git-blogging-with-aerial#disqus_thread'></a>
                    </span>
                  </h2>
                  <div class='cl'>&nbsp;</div>
                </div>
                <div class='body'>
                  <p class='with-border'>
                    <p>Over the last few years, I have grown tired of maintaining, migrating, and upgrading blog software, so I've decided to roll my own with Ruby code. In doing so, I wanted to keep things as simple as possible with a basic set of features: articles, pages, comments, rss, etc. What I didn't want is a SQL database or an administration tool. I wanted to write articles in my text editor of choice (Emacs), in <a href="http://daringfireball.net/projects/markdown/">Markdown</a> format, and versioned with <a href="http://git-scm.com/">Git</a>. So I've ported this site from Mephisto to my own custom creation. I call it Aerial.</p><p>Much inspiration for Aerial has come from <a href="http://github.com/karmi/marley">Marley</a>, a minimal flat-file blog engine written in Sinatra. Like Marley, Aerial is built with <a href="http://www.sinatrarb.com/">Sinatra</a> and uses plain text files. Unlike Marley, Aerial doesn't use a SQL database and uses <a href="http://github.com/mojombo/grit">Grit</a> to retrieve article and comment files from a Git repository.</p><h2>So how does it work?</h2><p>Articles and comments are stored as plain text files in a local Git directory. Aerial parses each file and converts them the Article and Comment objects with their own set of attributes such as title, body, tags, and author. For example, this article looks something like this:</p><pre><code>Title      : Git blogging with Aerial&#x000A;Tags       : projects, ruby, git, sinatra&#x000A;Published  : 03/28/2009&#x000A;Author     : Matt Sears&#x000A;&#x000A;Over the last few years...&#x000A;</code></pre><p>Since Aerial reads the articles from the Git repository, the contents of article won't display in the browser unless the changes are committed to Git. Same goes for comments.</p><h2>Working with remote repositories</h2><p>Aerial uses local and remote Git repositories to sync data between the production web server and your local environment. For example, when comments are submitted on the production web server, they are checked for Spam via <a href="http://akismet.com/">Akismet</a> and saved to the same directory as the article. Then, the new comment file is added to the production web server's repository and pushed to the remote repository (Github in my case). To pull in user comments to our local environment, simply use the pull command:</p><pre><code>git pull&#x000A;</code></pre><p>Now we have all the comments that users have submitted.</p><h2>Getting Started</h2><p>For Aerial to work, you'll need Git installed and the following RubyGems:</p><pre><code>sudo gem install sinatra grit rdiscount haml&#x000A;</code></pre><p>Grab the <a href="http://github.com/mattsears/aerial">source code</a> from Github.</p><p>A small configuration file in config/config.yml is used to store information about your blog. You can add your info now or leave it as is and it will still work. To setup and run Aerial, we need to run the boostrap Rake task:</p><pre><code>rake bootstrap&#x000A;</code></pre><p>This will install the necessary directories (specified in the config.yml file), javascript files, and insert a sample article to get you started. If every goes smoothly, Aerial should be up and running at:</p><pre><code>http://localhost:4567&#x000A;</code></pre><p>Keeping in spirit with minimalism, all the pages use <a href="http://haml.hamptoncatlin.com">Haml</a> for the templating engine. Of course, you may change this to the templating engine of your choice.</p><h2>Creating new articles</h2><p>Create a new folder in the app/articles directory.  You can name this folder anything you want, but it may be helpful to number them so they display in the order you want them to. For example, the folder for this articles looks like this:</p><pre><code>app/articles/011-introducing-aerial&#x000A;</code></pre><p>Next, create a text file with the extension '.article' and save it to the new folder.  The '.article' file extension let's Aerial know that this file should be converted to an Article object.  The name of the article will be the article's permalink. Remember, the article will not display on the site until it's committed to the git repository. When the article is completed, we can push it to the remote repository with the push command:</p><pre><code>git push&#x000A;</code></pre><p>Now, we're ready to deploy it.</p><h2>Deployment</h2><p>Deployment tasks are handled with <a href="http://rubyhitsquad.com/Vlad_the_Deployer.html">Vlad the Deployer</a>. A simple deployment script is located at config/deploy.rb. It assumes your running Apache and Phusions Passenger, but you can edit this file with your own settings. Future enhancements may include auto-syncing with post-receive hooks so that 'git push' will make Aerial update itself, but for now we can deploy with a simple rake task:</p><pre><code>rake deploy&#x000A;</code></pre><p>This is by no means a comprehensive introduction. If you have any questions or run into any problems, please drop me a line.</p>
                  </p>
                </div>
              </div>
              <div class='post-bottom'>
                <script type='text/javascript'>
                  //<![CDATA[
                    var disqus_shortname = 'mattsears'; // required: replace example with your forum shortname
                    var disqus_identifier = "/articles/2009/4/4/git-blogging-with-aerial/";
                    var disqus_url = "http://www.mattsears.com/articles/2009/4/4/git-blogging-with-aerial";
                  //]]>
                </script>
              </div>
              
              <div class='post rounded-top'>
                <div class='head'>
                  <h2>
                    <a href='/articles/2008/11/8/quick-git-add-commit-push-and-deploy'>
                      Quick git add, commit, push, and deploy
                    </a>
                    <span>
                      <a class='dsq-comment-count comment-link commentslink' href='http://www.mattsears.com/articles/2008/11/8/quick-git-add-commit-push-and-deploy#disqus_thread'></a>
                    </span>
                  </h2>
                  <div class='cl'>&nbsp;</div>
                </div>
                <div class='body'>
                  <p class='with-border'>
                    <p>Last week, I was preparing a presentation and found myself doing a lot of quick fixes and deployments to prepare a web application for a demonstration.  I thought instead of running the following four commands each time:</p><pre><code>git add .&#x000A;git commit -a -m 'A description of the change'&#x000A;git push&#x000A;cap production deploy&#x000A;</code></pre><p>It would be nice if I could do all of the above with just one command.  So I created this shell script:</p><pre><code>push() {&#x000A;&#x000A;  # Defaults&#x000A;  MINLEN=25&#x000A;  DIRTY=false&#x000A;  DEPLOY="production deploy"&#x000A;  REMOTE_REPO = "origin master"&#x000A;&#x000A;  # Check if we have any untracked files&#x000A;  if git status | grep -q "modified:"&#x000A;  then&#x000A;     DIRTY=true&#x000A;  fi&#x000A;&#x000A;  # Make sure there is a message with the commit&#x000A;  if [ -z "$1" ] &amp;&amp; (test $DIRTY == true)&#x000A;  then&#x000A;    echo "You must specify a message with your commit"&#x000A;    return&#x000A;  elif [ ${#1} -lt $MINLEN ] &amp;&amp; (test $DIRTY == true)&#x000A;  then&#x000A;    echo "Your message must have at least $MINLEN letters."&#x000A;  return&#x000A;  fi&#x000A;&#x000A;  # Commit all the changes by default&#x000A;  if (test $DIRTY == true)&#x000A;  then&#x000A;     echo "Adding new files to Git repository"&#x000A;     git add .&#x000A;&#x000A;     echo "Commiting to local Git repository"&#x000A;     git commit -a -m "$1"&#x000A;&#x000A;     # Push changes if a remote repository exists&#x000A;     if git remote | grep -q "origin"&#x000A;     then&#x000A;        echo "Pushing changes to remote repository"&#x000A;        git push $REMOTE_REPO&#x000A;     fi&#x000A;  fi&#x000A;&#x000A;  # Deploy changes via Capistrano&#x000A;  if ls | grep -q Capfile&#x000A;  then&#x000A;     cap $DEPLOY&#x000A;  fi&#x000A;}&#x000A;</code></pre><p>The 'push' function will first check to make sure you supplied a description if any recent changes were made.  Second, it will commit all the code and push it to the remote repository (if one exists).</p><p>If none of the code was modified or added, it will skip the Git commands and simply run the Capistrano deploy command and not require a description for the changes.</p><p>To use this script, copy and paste the above function to the end of your ~/.bash_profile file. To run it, simply run the 'push' command.</p><pre><code>push "The description for the committed changes."&#x000A;</code></pre><p>That's it!  All the code is added, commited, pushed, and deployed.</p>
                  </p>
                </div>
              </div>
              <div class='post-bottom'>
                <script type='text/javascript'>
                  //<![CDATA[
                    var disqus_shortname = 'mattsears'; // required: replace example with your forum shortname
                    var disqus_identifier = "/articles/2008/11/8/quick-git-add-commit-push-and-deploy/";
                    var disqus_url = "http://www.mattsears.com/articles/2008/11/8/quick-git-add-commit-push-and-deploy";
                  //]]>
                </script>
              </div>
            </div>
          </div>
          <div id='sidebar'>
            <div class='get-in-touch'>
              <div class='me'>
                <img class='fade' src='/images/me.png' style='background: url(/images/me!.png)' />
              </div>
              <p>
                Hi. I'm Matt Sears, a web developer
                <span class='amp'>&</span>
                entrepreneur in Ohio. I run
                <a href='http://littlelines.com' rel='external'>Littlelines,</a>
                a distinguished web development and design firm.
              </p>
              <p>
                I use this blog to share my ideas and as a way to learn.
                Feel free to contact me via email or follow me on Twitter at
                <a href='https://twitter.com/mattsears' rel='external'>
                  @mattsears.
                </a>
              </p>
            </div>
            <div class='elsewhere'>
              <h4>Connect</h4>
              <ul>
                <li>
                  <a class='small-ico-external' href='https://twitter.com/mattsears' rel='external'>Twitter</a>
                </li>
                <li>
                  <a class='small-ico-external' href='http://www.facebook.com/mattsears.me' rel='external'>Facebook</a>
                </li>
                <li>
                  <a class='small-ico-external' href='http://www.linkedin.com/in/matthewsears' rel='external'>LinkedIn</a>
                </li>
                <li>
                  <a class='small-ico-external' href='http://github.com/mattsears' rel='external'>Github</a>
                </li>
                <li>
                  <a class='small-ico-external' href='https://plus.google.com/106286747861473847411' rel='external'>Google+</a>
                </li>
                <li>
                  <a class='small-ico-external' href='http://forrst.me/mattsears.me' rel='external'>Forrst</a>
                </li>
                <li>
                  <a class='small-ico-external' href='http://www.flickr.com/photos/matthewsears' rel='external'>Flickr</a>
                </li>
                <li class='last'>
                  <a class='small-ico-external' href='http://mattsears.tumblr.com' rel='external'>Tumblr</a>
                </li>
              </ul>
            </div>
            <div class='recent-posts'>
              <h4>Recent Posts</h4>
              <ul>
                <li>
                  <a href='/articles/2011/11/27/ruby-blocks-as-dynamic-callbacks'>Ruby Blocks as Dynamic Callbacks</a>
                </li>
                <li>
                  <a href='/articles/2011/11/16/nyan-cat-rspec-formatter'>Nyan Cat RSpec Formatter</a>
                </li>
                <li>
                  <a href='/articles/2011/10/20/gaga-key-value-store'>Gaga: A Git-Backed Key/Value Store</a>
                </li>
                <li>
                  <a href='/articles/2011/5/15/print-stamps-with-ruby'>Print Stamps With Ruby!</a>
                </li>
                <li>
                  <a href='/articles/2011/1/11/easy-multiple-account-management-for-heroku'>Easy Multiple Account Management for Heroku</a>
                </li>
              </ul>
            </div>
            <div class='categories'>
              <h4>Categories</h4>
              <ul>
                <li>
                  <a href='/articles/tags/ruby'>ruby</a>
                </li>
                <li>
                  <a href='/articles/tags/git'>git</a>
                </li>
                <li>
                  <a href='/articles/tags/rails'>rails</a>
                </li>
                <li>
                  <a href='/articles/tags/clojure'>clojure</a>
                </li>
                <li>
                  <a href='/articles/tags/code'>code</a>
                </li>
                <li>
                  <a href='/articles/tags/projects'>projects</a>
                </li>
                <li>
                  <a href='/articles/tags/sinatra'>sinatra</a>
                </li>
                <li>
                  <a href='/articles/tags/conference'>conference</a>
                </li>
                <li>
                  <a href='/articles/tags/capistrano'>capistrano</a>
                </li>
                <li>
                  <a href='/articles/tags/passenger'>passenger</a>
                </li>
                <li>
                  <a href='/articles/tags/littlelines'>littlelines</a>
                </li>
                <li>
                  <a href='/articles/tags/architecture'>architecture</a>
                </li>
                <li>
                  <a href='/articles/tags/news'>news</a>
                </li>
              </ul>
            </div>
            <div class='archives'>
              <h4>Archives</h4>
              <ul>
                <li>
                  <a href='/articles/archives/2011/11'>November 2011 (2)</a>
                </li>
                <li>
                  <a href='/articles/archives/2011/10'>October 2011 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2011/05'>May 2011 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2011/01'>January 2011 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2009/10'>October 2009 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2009/06'>June 2009 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2009/04'>April 2009 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2008/12'>December 2008 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2008/11'>November 2008 (2)</a>
                </li>
                <li>
                  <a href='/articles/archives/2008/08'>August 2008 (1)</a>
                </li>
                <li>
                  <a href='/articles/archives/2008/07'>July 2008 (5)</a>
                </li>
                <li>
                  <a href='/articles/archives/2008/01'>January 2008 (1)</a>
                </li>
              </ul>
            </div>
          </div>
          <div class='cl'>&nbsp;</div>
        </div>
    </div>
    <div id='footer'>
      <div class='shell'>
        <div class='left'>
          <p>&copy; Copyright 2011 Matt Sears. All Rights Reserved.</p>
        </div>
        <p class='footer-navigation'>
          Powered by
          <a href='http://mattsears.github.com/aerial' rel='external'>Aerial</a>
          on
          <a href='http://heroku.com' rel='external'>Heroku</a>
        </p>
        <div class='cl'>&nbsp;</div>
      </div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        Cufon.now();
        //
        (function () {
          var disqus_shortname = 'mattsears';
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        //
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-2776418-3']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      //]]>
    </script>
  </body>
</html>
