<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir='ltr' lang='en-US' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='Content-type' />
    <title>Matt Sears | Articles</title>
    <meta content='Matt Sears, Matt, Sears' name='keywords' />
    <meta author='Matt Sears' />
    <link href='http://example.org/feed.xml' rel='alternate' title='Feed for mattsears' type='application/atom+xml' />
    <link href='/images/favicon.png' rel='shortcut icon' />
    <link href='/style.css' media='all' rel='stylesheet' type='text/css' />
    <!--[if IE 6]>
      <link rel="stylesheet" href="css/ie6.css" type="text/css" media="all" />
    <![endif]-->
    <script charset='utf-8' src='/javascripts/jquery-1.4.2.min.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/cufon-yui.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/titillium_400_mod2.font.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/titillium_800_mod2.font.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/cross-fade.js' type='text/javascript'></script>
    <script charset='utf-8' src='/javascripts/application.js' type='text/javascript'></script>
  </head>
  <body class='articles'>
    <div class='page-bg'>&nbsp;</div>
    <div id='header'>
      <div class='shell'>
        <div class='cl'>&nbsp;</div>
        <a href='/'>
          <h1 class='nocufon' id='logo'></h1>
        </a>
        <div class='right'>
          <div class='cl'>&nbsp;</div>
          <div id='navigation'>
            <ul>
              <li class='home-link'>
                <a href='/'>Home</a>
              </li>
              <li class='divider'>/</li>
              <li class='articles-link'>
                <a href='/articles'>Articles</a>
              </li>
              <li class='divider'>/</li>
              <li class='tumblr-link'>
                <a href='http://mattsears.tumblr.com'>Notebook</a>
              </li>
              <li class='divider'>/</li>
              <li class='about-link'>
                <a href='/about'>About</a>
              </li>
              <li class='divider'>/</li>
              <li class='contact-link'>
                <a href='mailto:matt@mattsears.com'>
                  Contact
                </a>
              </li>
            </ul>
          </div>
          <div class='cl'>&nbsp;</div>
        </div>
        <div class='cl'>&nbsp;</div>
      </div>
    </div>
    <div id='main'>
      <div class='shell'>
        <div id='content'>
          <div id='content-top'></div>
          <div class='posts'>
            <div class='post'>
              <div class='head'>
                <h2>
                  <a href='/articles/2008/11/8/quick-git-add-commit-push-and-deploy'>
                    Quick git add, commit, push, and deploy
                  </a>
                  <span>
                    <a class='dsq-comment-count comment-link commentslink' href='articles/2008/11/8/quick-git-add-commit-push-and-deploy#disqus_thread'></a>
                  </span>
                </h2>
                <div class='cl'>&nbsp;</div>
              </div>
              <div class='body'>
                <p class='with-border'>
                  <p>Last week, I was preparing a presentation and found myself doing a lot of quick fixes and deployments to prepare a web application for a demonstration.  I thought instead of running the following four commands each time:</p>
                  
                  <pre><code>git add .&#x000A;git commit -a -m 'A description of the change'&#x000A;git push&#x000A;cap production deploy&#x000A;</code></pre>
                  
                  <p>It would be nice if I could do all of the above with just one command.  So I created this shell script:</p>
                  
                  <pre><code>push() {&#x000A;&#x000A;  # Defaults&#x000A;  MINLEN=25&#x000A;  DIRTY=false&#x000A;  DEPLOY="production deploy"&#x000A;  REMOTE_REPO = "origin master"&#x000A;&#x000A;  # Check if we have any untracked files&#x000A;  if git status | grep -q "modified:"&#x000A;  then&#x000A;     DIRTY=true&#x000A;  fi&#x000A;&#x000A;  # Make sure there is a message with the commit&#x000A;  if [ -z "$1" ] &amp;&amp; (test $DIRTY == true)&#x000A;  then&#x000A;    echo "You must specify a message with your commit"&#x000A;    return&#x000A;  elif [ ${#1} -lt $MINLEN ] &amp;&amp; (test $DIRTY == true)&#x000A;  then&#x000A;    echo "Your message must have at least $MINLEN letters."&#x000A;  return&#x000A;  fi&#x000A;&#x000A;  # Commit all the changes by default&#x000A;  if (test $DIRTY == true)&#x000A;  then&#x000A;     echo "Adding new files to Git repository"&#x000A;     git add .&#x000A;&#x000A;     echo "Commiting to local Git repository"&#x000A;     git commit -a -m "$1"&#x000A;&#x000A;     # Push changes if a remote repository exists&#x000A;     if git remote | grep -q "origin"&#x000A;     then&#x000A;        echo "Pushing changes to remote repository"&#x000A;        git push $REMOTE_REPO&#x000A;     fi&#x000A;  fi&#x000A;&#x000A;  # Deploy changes via Capistrano&#x000A;  if ls | grep -q Capfile&#x000A;  then&#x000A;     cap $DEPLOY&#x000A;  fi&#x000A;}&#x000A;</code></pre>
                  
                  <p>The 'push' function will first check to make sure you supplied a description if any recent changes were made.  Second, it will commit all the code and push it to the remote repository (if one exists).</p>
                  
                  <p>If none of the code was modified or added, it will skip the Git commands and simply run the Capistrano deploy command and not require a description for the changes.</p>
                  
                  <p>To use this script, copy and paste the above function to the end of your ~/.bash_profile file. To run it, simply run the 'push' command.</p>
                  
                  <pre><code>push "The description for the committed changes."&#x000A;</code></pre>
                  
                  <p>That's it!  All the code is added, commited, pushed, and deployed.</p>
                </p>
              </div>
            </div>
            <div class='post-bottom'>
              <br />
              <div id='disqus_thread'></div>
              <script type='text/javascript'>
                //<![CDATA[
                  var disqus_shortname = 'mattsears'; // required: replace example with your forum shortname
                  // The following are highly recommended additional parameters. Remove the slashes in front to use.
                  var disqus_identifier = "/articles/2008/11/8/quick-git-add-commit-push-and-deploy/";
                  var disqus_url = "http://mattsears.com/articles/2008/11/8/quick-git-add-commit-push-and-deploy";
                  /* * * DON'T EDIT BELOW THIS LINE * * */
                  (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
                //]]>
              </script>
              <noscript>
                Please enable JavaScript to view the
                <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
              </noscript>
            </div>
          </div>
        </div>
        <div id='sidebar'>
          <div class='get-in-touch'>
            <div class='me'>
              <img class='fade' src='/images/me.png' style='background: url(images/me!.png)' />
            </div>
            <p>
              Hi. I'm Matt Sears, a web developer
              <span class='amp'>&</span>
              entrepreneur in Ohio. I run
              <a href='http://littlelines.com' rel='external'>Littlelines,</a>
              a distinguished web development and desgin firm.
            </p>
            <p>
              I use this blog to share my ideas and as a way to learn.
              Feel free to contact me via email or follow me on Twitter at
              <a href='https://twitter.com/mattsears' rel='external'>
                @mattsears.
              </a>
            </p>
          </div>
          <div class='elsewhere'>
            <h4>Connect</h4>
            <ul>
              <li>
                <a class='small-ico-external' href='https://twitter.com/mattsears' rel='external'>Twitter</a>
              </li>
              <li>
                <a class='small-ico-external' href='http://www.facebook.com/profile.php?id=1389547090' rel='external'>Facebook</a>
              </li>
              <li>
                <a class='small-ico-external' href='http://www.linkedin.com/in/matthewsears' rel='external'>LinkedIn</a>
              </li>
              <li>
                <a class='small-ico-external' href='http://github.com/mattsears' rel='external'>Github</a>
              </li>
              <li>
                <a class='small-ico-external' href='http://forrst.com/people/mattsears' rel='external'>Forrst</a>
              </li>
              <li>
                <a class='small-ico-external' href='http://www.flickr.com/photos/matthewsears' rel='external'>Flickr</a>
              </li>
              <li class='last'>
                <a class='small-ico-external' href='http://mattsears.tumblr.com' rel='external'>Tumblr</a>
              </li>
            </ul>
          </div>
          <div class='recent-posts'>
            <h4>Recent Posts</h4>
            <ul>
              <li>
                <a href='articles/2011/5/15/print-stamps-with-ruby'>Print Stamps With Ruby!</a>
              </li>
              <li>
                <a href='articles/2011/1/11/easy-multiple-account-management-for-heroku'>Easy Multiple Account Management for Heroku</a>
              </li>
              <li>
                <a href='articles/2009/10/31/5-ruby-gems-for-concise-code'>5 Ruby Gems for Concise Code</a>
              </li>
              <li>
                <a href='articles/2009/6/6/20-clojure-links-to-get-you-up-to-speed'>20 Clojure Links To Get You Up To Speed</a>
              </li>
              <li>
                <a href='articles/2009/4/4/git-blogging-with-aerial'>Git blogging with Aerial</a>
              </li>
            </ul>
          </div>
          <div class='categories'>
            <h4>Categories</h4>
            <ul>
              <li>
                <a href='/tags/ruby'>ruby</a>
              </li>
              <li>
                <a href='/tags/rails'>rails</a>
              </li>
              <li>
                <a href='/tags/clojure'>clojure</a>
              </li>
              <li>
                <a href='/tags/code'>code</a>
              </li>
              <li>
                <a href='/tags/projects'>projects</a>
              </li>
              <li>
                <a href='/tags/git'>git</a>
              </li>
              <li>
                <a href='/tags/sinatra'>sinatra</a>
              </li>
              <li>
                <a href='/tags/conference'>conference</a>
              </li>
              <li>
                <a href='/tags/capistrano'>capistrano</a>
              </li>
              <li>
                <a href='/tags/passenger'>passenger</a>
              </li>
              <li>
                <a href='/tags/littlelines'>littlelines</a>
              </li>
              <li>
                <a href='/tags/architecture'>architecture</a>
              </li>
              <li>
                <a href='/tags/news'>news</a>
              </li>
            </ul>
          </div>
          <div class='archives'>
            <h4>Archives</h4>
            <ul>
              <li>
                <a href='/archives/2011/05'>May 2011 (1)</a>
              </li>
              <li>
                <a href='/archives/2011/01'>January 2011 (1)</a>
              </li>
              <li>
                <a href='/archives/2009/10'>October 2009 (1)</a>
              </li>
              <li>
                <a href='/archives/2009/06'>June 2009 (1)</a>
              </li>
              <li>
                <a href='/archives/2009/04'>April 2009 (1)</a>
              </li>
              <li>
                <a href='/archives/2008/12'>December 2008 (1)</a>
              </li>
              <li>
                <a href='/archives/2008/11'>November 2008 (2)</a>
              </li>
              <li>
                <a href='/archives/2008/08'>August 2008 (1)</a>
              </li>
              <li>
                <a href='/archives/2008/07'>July 2008 (5)</a>
              </li>
              <li>
                <a href='/archives/2008/01'>January 2008 (1)</a>
              </li>
            </ul>
          </div>
        </div>
        <div class='cl'>&nbsp;</div>
      </div>
    </div>
    <div id='footer'>
      <div class='shell'>
        <div class='left'>
          <p>&copy; Copyright 2011 Matt Sears. All Rights Reserved.</p>
        </div>
        <p class='footer-navigation'>
          Powered by
          <a href='http://mattsears.github.com/aerial' rel='external'>aerial</a>
          on
          <a href='http://heroku.com' rel='external'>heroku</a>
        </p>
        <div class='cl'>&nbsp;</div>
      </div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        Cufon.now();
        //
        (function() {
          var links = document.getElementsByTagName('a');
          var query = '?';
          for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
            query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
          }
          document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/mattsears/get_num_replies.js' + query + '"></' + 'script>');
        })();
        //
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-2776418-3']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      //]]>
    </script>
  </body>
</html>
